 {
    var cwd, exec, fs, hostname, ini, iniLocation, orcad, os, path;
    orcad = {};
    orcad.schema = "[circuithub.dbc]\nColNameHeader=False\nFormat=CSVDelimited\nMaxScanRows=25\nCharacterSet=OEM\n[parts.csv]\nColNameHeader=True\nFormat=CSVDelimited\nMaxScanRows=25\nCharacterSet=OEM\nCol1=CIRCUITHUBID Char Width 255\nCol2=CATEGORY Char Width 255\nCol3=MANUFACTURER Char Width 255\nCol4=MPN Char Width 255\nCol5=VALUE Char Width 255\nCol6=\"SCHEMATIC PART\" Char Width 255\nCol7=\"ALLEGRO PCB FOOTPRINT\" Char Width 255\nCol8=\"3D MODEL\" Char Width 255\nCol9=\"URL\" Char Width 255";
    orcad.reg = function(path) {
      path = path.replace(/\\/g, "\\\\");
      return "Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\CircuitHub-OrCAD]\n\"Driver\"=\"C:\\\\Windows\\\\system32\\\\odbcjt32.dll\"\n\"DefaultDir\"=\"" + path + "\"\n\"Description\"=\"CircuitHub-OrCAD\"\n\"DriverId\"=dword:0000001b\n\"FIL\"=\"text;\"\n\"SafeTransactions\"=dword:00000000\n\"UID\"=\"\"\n\n[HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\CircuitHub-OrCAD\\Engines]\n\n[HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\CircuitHub-OrCAD\\Engines\\Text]\n\"Extensions\"=\"txt,csv,tab,asc\"\n\"ImplicitCommitSync\"=\"\"\n\"Threads\"=dword:00000003\n\"UserCommitSync\"=\"Yes\"\n\n[HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\ODBC Data Sources]\n\"CircuitHub-OrCAD\"=\"Microsoft Text Driver\"";
    };
    orcad.dbc = function(hostname) {
      return "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n<CFGManager>\n\n  <!--CIS DBC configuration file 16.3 release. Created on (date/time) Tue Sep 25 00:06:10 2012\n-->\n\n  <CISVersion>\n    <Value>CIS Version 16.3</Value>\n  </CISVersion>\n\n  <LastModifiedTime>1348527968</LastModifiedTime>\n\n  <AllowDuplicatePartNumbers>1</AllowDuplicatePartNumbers>\n\n  <PartTypeDelimiter>\\</PartTypeDelimiter>\n\n  <TransferBlankProperties>0</TransferBlankProperties>\n\n  <AssignTempPartNoAutomatically>0</AssignTempPartNoAutomatically>\n\n  <TempPartNumberTableName>TMPPRTS</TempPartNumberTableName>\n\n  <TempPartNumberPrefix>TMP-</TempPartNumberPrefix>\n\n  <MultiValuesCellDelimiter>,</MultiValuesCellDelimiter>\n\n  <UseTopSup>0</UseTopSup>\n\n  <DoNotStuffString>Do Not Stuff</DoNotStuffString>\n\n  <MechPartMappingTable>MechPart Mapping Table</MechPartMappingTable>\n\n  <Version>2457</Version>\n\n  <DSNName>CircuitHub-OrCAD</DSNName>\n\n  <AssistMode>0</AssistMode>\n\n  <AutoPartTypeRefresh>1</AutoPartTypeRefresh>\n\n  <PartNumber>0</PartNumber>\n\n  <PartRefernce>1</PartRefernce>\n\n  <RefDesAssoc/>\n\n  <SelectedICASupList indx=\"0\">\n    <ICASuplierList>Allied</ICASuplierList>\n  </SelectedICASupList>\n\n  <SelectedICASupList indx=\"1\">\n    <ICASuplierList>Digi-Key</ICASuplierList>\n  </SelectedICASupList>\n\n  <SelectedICASupList indx=\"2\">\n    <ICASuplierList>Marshall</ICASuplierList>\n  </SelectedICASupList>\n\n  <SelectedICASupList indx=\"3\">\n    <ICASuplierList>NUHorizons</ICASuplierList>\n  </SelectedICASupList>\n\n  <DbTableCfg indx=\"0\">\n    <NewPartDB>0</NewPartDB>\n    <TableName>parts_" + hostname + ".csv</TableName>\n    <TableUsed>1</TableUsed>\n    <DbFieldDef indx=\"0\">\n      <FieldName>CircuitHubID</FieldName>\n      <DBFieldName>CircuitHubID</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>1</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"1\">\n      <FieldName>CircuitHubRev</FieldName>\n      <DBFieldName>CircuitHubRev</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>1</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>0</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"2\">\n      <FieldName>Category</FieldName>\n      <DBFieldName>Category</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>1</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>2</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"3\">\n      <FieldName>Manufacturer</FieldName>\n      <DBFieldName>Manufacturer</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>0</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"4\">\n      <FieldName>MPN</FieldName>\n      <DBFieldName>MPN</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>0</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"5\">\n      <FieldName>Value</FieldName>\n      <DBFieldName>Value</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>0</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"6\">\n      <FieldName></FieldName>\n      <DBFieldName>Schematic Part</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>1</Ignore>\n      <Visibility>2</Visibility>\n      <PropertyType>3</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"7\">\n      <FieldName>Allegro PCB Footprint</FieldName>\n      <DBFieldName>Allegro PCB Footprint</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>2</Visibility>\n      <PropertyType>4</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"8\">\n      <FieldName>3D Model</FieldName>\n      <DBFieldName>3D Model</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>0</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n    <DbFieldDef indx=\"9\">\n      <FieldName>URL</FieldName>\n      <DBFieldName>URL</DBFieldName>\n      <ICAFieldName></ICAFieldName>\n      <DBFieldType>12</DBFieldType>\n      <DBFieldPrecision>255</DBFieldPrecision>\n      <DBFieldLength>510</DBFieldLength>\n      <DBFieldScale>32484</DBFieldScale>\n      <DBFieldRadix>32484</DBFieldRadix>\n      <DBFieldNullable>0</DBFieldNullable>\n      <Browse>0</Browse>\n      <Protected>0</Protected>\n      <Key>0</Key>\n      <Ignore>0</Ignore>\n      <Visibility>0</Visibility>\n      <PropertyType>0</PropertyType>\n      <UpdatePartProp>1</UpdatePartProp>\n    </DbFieldDef>\n  </DbTableCfg>\n\n</CFGManager>\n";
    };
    os = require("os");
    fs = require("fs");
    exec = require("child_process").exec;
    hostname = os.hostname();
    cwd = process.cwd();
    console.log("\n\nSetting up OrCAD and Allegro for your computer with hostname: " + hostname + "\n\n");
    if (fs.existsSync("path.json")) {
      path = JSON.parse(fs.readFileSync("path.json").toString());
    } else {
      path = {};
    }
    path[hostname] = cwd;
    fs.writeFileSync("path.json", JSON.stringify(path));
    fs.writeFileSync("circuithub_" + hostname + ".dbc", orcad.dbc(hostname));
    fs.writeFileSync("odbc_setup_" + hostname + ".reg", orcad.reg(cwd));
    if (!fs.existsSync("parts_" + hostname + ".csv")) {
      fs.writeFileSync("parts_" + hostname + ".csv", "CircuitHubID, CircuitHubRev, Category, Manufacturer, MPN, Value, Schematic Part, Allegro PCB Footprint, 3D Model, URL\nempty, empty, part, empty, empty, empty, empty, empty, empty, empty");
    }
    console.log("\n\nClick YES then OK to add registry keys required by OrCAD CIS.\n\n");
    exec("odbc_setup_" + hostname + ".reg", function(error, stdout, stderr) {});
    iniLocation = "" + process.env.CDSROOT + "\\tools\\capture\\capture.ini";
    ini = fs.readFileSync(iniLocation).toString();
    ini = ini.replace("[Part Management]", "[Part Management]\nDemoConfiguration File=" + cwd + "\\circuithub_" + hostname + ".dbc\nConfiguration File=" + cwd + "\\circuithub_" + hostname + ".dbc");
    fs.writeFileSync(iniLocation, ini);
    return console.log("\n\ncapture.ini at location " + iniLocation + " appended.\n\n");
  }